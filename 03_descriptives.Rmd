---
title: "03_descriptives"
output: html_document
date: '2022-04-01'
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Library
```{r}
library(dplyr)
library(formr)
library(ggplot2)
```

## Load data
```{r}
data_main = read.csv(file = "data/data_main.csv")[,-1]
```

### Demographic data
#### Sexual orientation
```{r}
table(data_main$sexual_orientation) # sexual orientation in absolute numbers
round(table(data_main$sexual_orientation)/sum(table(data_main$sexual_orientation)),4)*100 # sexual orientation in percent
```

#### Country
```{r}
table(data_main$country) # country in absolute numbers
round(table(data_main$country)/sum(table(data_main$country)),4)*100 # country in percent
table(is.na(data_main$country)) # no NAs 
```

#### Language
Chinese, Danish, English, French, German, Japanese, Portuguese, Russian, Spanish, Italian
```{r Language}
table(data_main$language) # language in absolute numbers
round(table(data_main$country)/sum(table(data_main$country)),4)*100 # country in percent
table(is.na(data_main$language)) #no NAs
```

#### Age
```{r}
table(data_main$age)
range(data_main$age, na.rm = T) # range
table(is.na(data_main$age)) # NAs
# histogram 
hist(data_main$age)

# mean, sd
mean(data_main$age, na.rm = T)
sd(data_main$age, na.rm = T)
```

### Sex 
Gender
Categories: Woman; Genderqueer/Nonbinary; Man; None of the above; Prefer not to say; Other
```{r Sex}
table(data_main$sex) # in absolute numbers
round(table(data_main$sex)/sum(table(data_main$sex)),4)*100 # in percent
table(is.na(data_main$sex))
```

### Transgender
```{r Transgender}
table(data_main$transgender) # in absolute numbers
round(table(data_main$transgender)/sum(table(data_main$transgender)),4)*100 # in percent
table(is.na(data_main$transgender))
```

#### Relationship status
```{r}
table(data_main$relationship_status) # in absolute numbers
round(table(data_main$relationship_status)/sum(table(data_main$relationship_status)),4)*100 # in percent
table(is.na(data_main$relationship_status)) # NAs
```

#### Relationship length 
```{r}
table(data_main$relationship_length)
range(data_main$relationship_length, na.rm = T) # range
table(is.na(data_main$relationship_length)) # NAs
# histogram
hist(data_main$relationship_length)

# mean, sd
mean(data_main$relationship_length, na.rm = T)
sd(data_main$relationship_length, na.rm = T)
```


### Marital Status
```{r}
table(data_main$marital_status) # in absolute numbers
round(table(data_main$marital_status)/sum(table(data_main$marital_status)),4)*100 # in percent
table(is.na(data_main$marital_status)) # NAs
```

### Political Spectrum
```{r}
table(data_main$political_spectrum) # in absolute numbers
round(table(data_main$political_spectrum)/sum(table(data_main$political_spectrum)),4)*100 # in percent
table(is.na(data_main$political_spectrum)) # NAs
```


### Outcomes
#### Relationship options
```{r}
data_main %>%
  select(interest_hookups,
         interest_nonsexrel,
         interest_monrel,
         interest_monrel,
         interest_altrel,
         interest_single,
         interest_parent) %>% 
  colMeans(na.rm = T) 


round(apply(data_main %>% select(interest_hookups,
                                 interest_nonsexrel,
                                 interest_monrel,
                                 interest_monrel,
                                 interest_altrel,
                                 interest_parent),2, sd, na.rm = T),2)

table(is.na(data_main$interest_hookups))
table(is.na(data_main$interest_nonsexrel))
table(is.na(data_main$interest_monrel))
table(is.na(data_main$interest_nonmonrel))
table(is.na(data_main$interest_altrel))
table(is.na(data_main$interest_single))
table(is.na(data_main$interest_parent))
```

#### Partner preferences
```{r}
data_main %>% select(pref_imp_ks,
                     pref_imp_att,
                     pref_imp_fs,
                     pref_imp_ca,
                     pref_imp_ei) %>% 
              colMeans(na.rm = T) 


round(apply(data_main %>% select(pref_imp_ks,
                                 pref_imp_att,
                                 pref_imp_fs,
                                 pref_imp_ca,
                                 pref_imp_ei),2, sd, na.rm = T),2)

table(is.na(data_main$pref_imp_ks))
table(is.na(data_main$pref_imp_att))
table(is.na(data_main$pref_imp_fs))
table(is.na(data_main$pref_imp_ca))
table(is.na(data_main$pref_imp_ei))
```

#### Self ratings
```{r}
data_main %>% select(self_ks,
                     self_att,
                     self_fs,
                     self_ca,
                     self_ei) %>% 
              colMeans(na.rm = T) 


round(apply(data_main %>% select(self_ks,
                                 self_att,
                                 self_fs,
                                 self_ca,
                                 self_ei),2, sd, na.rm = T),2)


table(is.na(data_main$self_ks))
table(is.na(data_main$self_att))
table(is.na(data_main$self_fs))
table(is.na(data_main$self_ca))
table(is.na(data_main$self_ei))
```


### Descriptives by sexual orientation
```{r}
describe.by(data_main, data_main$sexual_orientation)
```


### zero-order correlations
```{r}
# # zero order correlations for offspring and parents based on averaged parent scores from per offspring data frame
# corr_prefs = rcorr(as.matrix(data_offspring %>% select(off_prefs_WT, off_prefs_VA, off_prefs_SR, off_prefs_CH,
#                                                    off_prefs_FO,parent_prefs_WT, parent_prefs_VA,
#                                                    parent_prefs_SR,parent_prefs_CH,  parent_prefs_FO)))
# 
# 
# # correlations rounded to 2 decimals
# round(corr_prefs[[1]],2)
# 
# # number of observations
# corr_prefs[[2]]
# 
# # p-values rounded to 4 decimals
# round(corr_prefs[[3]],4)


```



### Zero-Order Correlations
```{r}
library(apaTables)

correlations = data_main %>%
  select(sexual_orientation,
         age,
         interest_hookups,
         interest_nonsexrel,
         interest_monrel,
         interest_monrel,
         interest_altrel,
         interest_single,
         interest_parent)

correlations_table = apa.cor.table(correlations, filename = "Table.doc", table.number = 4)

correlations_table

```




