---
title: "01_exlcuded_vs_included"
output: html_document
date: '2022-05-16'
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Library
```{r Library}
library(formr)
library(dplyr)
library(tidyr)
library(effsize)
```

## Create data set with only excluded partcipants
```{r}
# load wrangled data 
data_wrangled = read.csv(file = "data/data_wrangled.csv")[,-1]
data_main = read.csv(file = "data/data_main.csv")[,-1]

# Replace NAs for honesty question (so that values in both data sets are the same)
data_wrangled = data_wrangled %>% 
 mutate(answer_accuracy = replace_na(answer_accuracy, "No value"))

# merge data sets while excluding duplicates, leaving only the excluded participants
data_excluded = anti_join(data_wrangled, data_main)
```


## Descriptives for excluded data set
### Sexual orientation
```{r}
table(data_excluded$sexual_orientation) # sexual orientation in absolute numbers
round(table(data_excluded$sexual_orientation)/sum(table(data_excluded$sexual_orientation)),3)*100 # sexual orientation in percent
table(is.na(data_excluded$sexual_orientation)) # no NAs 
```

### Country
```{r}
table(data_excluded$country) # country in absolute numbers
round(table(data_excluded$country)/sum(table(data_excluded$country)),4)*100 # country in percent
table(is.na(data_excluded$country)) # no NAs 
```

### Language
Chinese, Danish, English, French, German, Japanese, Portuguese, Russian, Spanish, Italian
```{r Language}
table(data_excluded$language) # language in absolute numbers
round(table(data_excluded$country)/sum(table(data_excluded$country)),4)*100 # country in percent
table(is.na(data_excluded$language)) #no NAs
```

### Age
```{r}
table(data_excluded$age)
range(data_excluded$age, na.rm = T) # range
table(is.na(data_excluded$age)) # NAs

# histogram 
hist(data_excluded$age)

# mean, sd
round(mean(data_excluded$age, na.rm = T),2)
round(sd(data_excluded$age, na.rm = T),2)
```

### Sex 
Gender
Categories: Woman; Genderqueer/Nonbinary; Man; None of the above; Prefer not to say; Other
```{r Sex}
table(data_excluded$sex) # in absolute numbers
round(table(data_excluded$sex)/sum(table(data_excluded$sex)),3)*100 # in percent
table(is.na(data_excluded$sex))
```

### Relationship status
```{r}
table(data_excluded$relationship_status) # in absolute numbers
round(table(data_excluded$relationship_status)/sum(table(data_excluded$relationship_status)),3)*100 # in percent
table(is.na(data_excluded$relationship_status)) # NAs
```

### Relationship length 
```{r}
table(data_excluded$relationship_length)
range(data_excluded$relationship_length, na.rm = T) # range
table(is.na(data_excluded$relationship_length)) # NAs
# histogram
hist(data_excluded$relationship_length)

# mean, sd
round(mean(data_excluded$relationship_length, na.rm = T),2)
round(sd(data_excluded$relationship_length, na.rm = T),2)
```



## Comparison of exlcuded and included participants
### Add variabel indicating being excluded or included to each data set
```{r}
data_main$exclusion = "Included"
data_excluded$exclusion = "Excluded"
```

### Merge data sets
```{r}
data_exclusion = full_join(data_main, data_excluded)

# convert exclusion variable into factor
data_exclusion$exclusion = as.factor(data_exclusion$exclusion)
levels(data_exclusion$exclusion) # check factor levels
```

### Age
```{r}
t.test(age ~ exclusion, data = data_exclusion,
       alternative = "two.sided",
       paired = FALSE)

# effect size
effsize::cohen.d(age ~ exclusion, data = data_exclusion, paired = FALSE)
```

### Relationship length 
```{r}
t.test(relationship_length ~ exclusion, data = data_exclusion,
       alternative = "two.sided",
       paired = FALSE)


# effect size
effsize::cohen.d(relationship_length ~ exclusion, data = data_exclusion, paired = FALSE)
```

### Sexual orientation
```{r}
chisq_sexor = chisq.test(data_exclusion$exclusion, data_exclusion$sexual_orientation) # macht nicht so viel Sinn, da ja Ausschlusskriterium
chisq_sexor
chisq_sexor$observed
round(chisq_sexor$expected,2)
```

### Country
```{r}
chisq_country = chisq.test(data_exclusion$exclusion, data_exclusion$country) 
chisq_country
chisq_country$observed
round(chisq_country$expected,2)
```

### Language
Chinese, Danish, English, French, German, Japanese, Portuguese, Russian, Spanish, Italian
```{r Language}
chisq_language = chisq.test(data_exclusion$exclusion, data_exclusion$language) 
chisq_language
chisq_language$observed
round(chisq_language$expected,2)
```

### Sex
Gender
Categories: Woman; Genderqueer/Nonbinary; Man; None of the above; Prefer not to say; Other
```{r Sex}
chisq_sex = chisq.test(data_exclusion$exclusion, data_exclusion$sex) # macht nicht viel Sinn, da Ausschlusskriterium
chisq_sex
chisq_sex$observed
round(chisq_sex$expected,2)
```

### Relationship status
```{r}
chisq_relationship_status = chisq.test(data_exclusion$exclusion, data_exclusion$relationship_status) # macht nicht viel Sinn, da Ausschlusskriterium
chisq_relationship_status
chisq_relationship_status$observed
round(chisq_relationship_status$expected,2)
```

